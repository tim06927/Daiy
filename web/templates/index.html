<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Snap-to-Cart ‚Äì AI Component Finder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex,nofollow" />
  
  <!-- External Stylesheets -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/products.css') }}">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a href="/" class="logo" onclick="resetToInitial(); return false;">
        <span class="logo-icon">üõí</span>
        <span>A Snap-to-Cart Bike Retailer</span>
      </a>
      <nav>
        <ul class="nav">
          <li><a href="mailto:hello@daiy.de">Support</a></li>
          <li><a href="{{ url_for('privacy') }}">Privacy Policy</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="app-container">
    <!-- Initial State - Shop Style Search -->
    <section class="initial-state" id="initial-state">
      <div class="search-wrapper">
        <div class="tab-selector">
          <button class="tab-btn disabled" disabled>Search</button>
          <button class="tab-btn active">AI</button>
        </div>
        <div class="search-box-initial">
          <input type="file" id="upload-input" class="upload-input" accept="image/*" />
          <div class="search-row">
            <button class="upload-btn-initial" id="upload-btn" type="button" title="Upload photo">
              üì∑
            </button>
            <textarea 
              id="search-input" 
              class="search-input-initial" 
              placeholder="e.g., 'My 11-speed chain is worn, need a new chain and cassette'"
              rows="1"
            ></textarea>
            <button id="search-btn" class="search-btn-initial" type="button">
              ‚Üí
            </button>
          </div>
          <div class="image-preview-initial" id="image-preview">
            <img class="preview-thumb" id="preview-thumb" src="" alt="Preview" />
            <div class="preview-info">
              <div class="preview-name" id="preview-name"></div>
              <div class="preview-size" id="preview-size"></div>
            </div>
            <button class="preview-remove" id="preview-remove" type="button" title="Remove image">√ó</button>
          </div>
        </div>
        <p class="initial-hint">Press <kbd>Enter</kbd> to search ¬∑ <kbd>Shift+Enter</kbd> for new line</p>
      </div>
      
      <div class="hero-section">
        <p class="hero-tagline">Upload a photo or describe your problem. We'll find the right parts and explain why they fit.</p>
      </div>
      
      <!-- Alpha Notice -->
      <div class="alpha-notice">
        <p>‚ö†Ô∏è <strong>Alpha demo</strong> ‚Äî please don't enter personal data (name, email, phone, address).</p>
      </div>
      
      {% if show_demo_notice %}
      <div class="disclaimer">
        <p><strong>Demo Notice:</strong> This demo currently features a limited selection of bike drivetrain products (chains, cassettes, and related parts). For best results, try queries like "replace my worn 11-speed cassette" or "find a chain for my road bike." You can ask about other topics, but recommendations will only come from our current product catalog. Want to help expand it? <a href="https://github.com/tim06927/Daiy" target="_blank" rel="noopener">Contribute on GitHub</a>.</p>
      </div>
      {% endif %}
    </section>

    <!-- Results State - Split Panel -->
    <section class="results-state" id="results-state">
      <div class="split-panel">
        <!-- Left Panel - Query Context -->
        <div class="query-panel">
          <div class="query-image-container" id="query-image-container">
            <div class="query-image-placeholder" id="query-image-placeholder" onclick="triggerUploadInResults()">
              <span class="icon">üì∑</span>
              <span class="text">Upload or Snap Photo</span>
            </div>
            <img class="query-image hidden" id="query-image" src="" alt="Your photo" />
          </div>
          
          <div class="query-text-container">
            <p class="query-text" id="query-text-display"></p>
            <button class="edit-query-btn" onclick="resetToInitial()">Edit query</button>
          </div>
          
          <div class="selected-options" id="selected-options">
            <!-- Dynamically populated with already selected speed/use-case -->
          </div>

          <div class="diagnosis-container hidden" id="diagnosis-container">
            <p class="diagnosis-text" id="diagnosis-text"></p>
          </div>
        </div>

        <!-- Right Panel - Results -->
        <div class="results-panel">
          <div class="loading-state" id="loading-state">
            <div class="loading-spinner"></div>
            <p class="loading-text">Finding the right parts for you...</p>
          </div>

          <div class="clarification-panel" id="clarification-panel">
            <div class="clarification-title">Help us narrow it down:</div>
            <div id="clarification-content">
              <!-- Dynamically populated with speed/use-case buttons -->
            </div>
          </div>

          <div class="error-message hidden" id="error-message"></div>

          <div class="product-categories" id="product-categories">
            <div class="results-tabs" id="results-tabs">
              <button class="results-tab active" data-tab="products">Products</button>
              <button class="results-tab" data-tab="instructions">Instructions</button>
            </div>
            
            <div class="tab-content active" id="products-tab">
              <div id="categories-container">
                <!-- Dynamically populated product categories -->
              </div>
            </div>

            <div class="tab-content" id="instructions-tab">
              <div class="instructions-content" id="instructions-content">
                <!-- Dynamically populated instructions -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Settings Panel - Sticky at bottom -->
  <div class="settings-container" id="settings-container">
    <button class="settings-toggle" id="settings-toggle" type="button">
      <span class="settings-icon">‚öôÔ∏è</span>
      <span class="settings-label">Settings</span>
      <span class="settings-chevron">‚ñ≤</span>
    </button>
    <div class="settings-panel" id="settings-panel">
      <div class="settings-content">
        <div class="setting-group">
          <label for="model-select">Model</label>
          <select id="model-select" class="setting-select">
            <!-- Options populated dynamically -->
          </select>
        </div>
        <div class="setting-group">
          <label for="effort-select">Reasoning Effort</label>
          <select id="effort-select" class="setting-select">
            <!-- Options populated dynamically -->
          </select>
        </div>
      </div>
    </div>
  </div>



  <!-- External JavaScript Modules -->
  <script src="{{ url_for('static', filename='js/config.js') }}"></script>
  <script src="{{ url_for('static', filename='js/state.js') }}"></script>
  <script src="{{ url_for('static', filename='js/utils.js') }}"></script>
  <script src="{{ url_for('static', filename='js/image.js') }}"></script>
  <script src="{{ url_for('static', filename='js/api.js') }}"></script>
  <script src="{{ url_for('static', filename='js/clarification.js') }}"></script>
  <script src="{{ url_for('static', filename='js/products.js') }}"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
